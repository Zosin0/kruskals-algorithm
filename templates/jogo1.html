<!DOCTYPE html>
<html lang="en">

<head>
    <title>O Jogo</title>
    <link rel="stylesheet" href="/static/style.css">
</head>

<body class="body1">
<main>
    <h2>
        Este é o mapa que Kruskal deixou, seu objetivo é seguir as regras do jogo.<br>
        Confira as 10 cidades localizadas no gráfico.
    </h2><br>
    <div class="mapa-completo">
        <img class="omapa" src="/static/assets/mapa.png" alt="mapa-completo">
        <div class="ospontos">
            <div name="1" class="oponto" style="top: 61px; left:244px;">1</div>
            <div name="2" class="oponto" style="top: 128px; left:128px;">2</div>
            <div name="3" class="oponto" style="top: 128px; left:347px;">3</div>
            <div name="4" class="oponto" style="top: 284px; left:128px;">4</div>
            <div name="5" class="oponto" style="top: 282px; left:347px;">5</div>
            <div name="6" class="oponto" style="top: 402px; left:128px;">6</div>
            <div name="7" class="oponto" style="top: 402px; left:347px;">7</div>
            <div name="8" class="oponto" style="top: 445px; left:245px;">8</div>
            <div name="9" class="oponto" style="top: 348px; left:238px;">9</div>
            <div name="10" class="oponto" style="top: 199px; left:238px;">10</div>
        </div>
        <div class="the-lines">

        </div>
    </div>

    <div class="asarestas">
        <h2>
            Selecione as arestas em ordem crescente, lembre-se das regras do jogo:
        </h2><br>
        <form>
            <!-- Adicionei um ID às divs de aresta para facilitar a ordenação -->
            <p>1 -- 2: 10Km</p><br><br>
            <div id="a1-2" data-weight="10" name="a1-2" class="aaresta" style="width: 100px"
                 onclick="adicionarAresta(3, '1', '2', 10)"></div>

            <p>1 -- 3: 11Km</p><br><br>
            <div id="a1-3" data-weight="11" name="a1-3" class="aaresta" style="width: 100px"
                 onclick="adicionarAresta(4, '1', '3', 11)"></div>

            <p>1 -- 10: 14Km</p><br><br>
            <div id="a1-10" data-weight="14" name="a1-10" class="aaresta" style="width: 100px"
                 onclick="adicionarAresta(6, '1', '10', 14)"></div>

            <p>2 -- 4: 23Km</p><br><br>
            <div id="a2-4" data-weight="23" name="a2-4" class="aaresta" style="width: 100px"
                 onclick="adicionarAresta(10, '2', '4', 23)"></div>

            <p>3 -- 5: 22Km</p><br><br>
            <div id="a3-5" data-weight="22" name="a3-5" class="aaresta" style="width: 100px"
                 onclick="adicionarAresta(9, '3', '5', 22)"></div>

            <p>4 -- 6: 15Km</p><br><br>
            <div id="a4-6" data-weight="15" name="a4-6" class="aaresta" style="width: 100px"
                 onclick="adicionarAresta(7, '4', '6', 15)"></div>

            <p>5 -- 7: 13Km</p><br><br>
            <div id="a5-7" data-weight="13" name="a5-7" class="aaresta" style="width: 100px"
                 onclick="adicionarAresta(5, '5', '7', 13)"></div>

            <p>6 -- 8: 9Km</p><br><br>
            <div id="a6-8" data-weight="9" name="a6-8" class="aaresta" style="width: 100px"
                 onclick="adicionarAresta(2, '6', '8', 9)"></div>

            <p>7 -- 8: 8Km</p><br><br>
            <div id="a7-8" data-weight="8" name="a7-8" class="aaresta" style="width: 100px"
                 onclick="adicionarAresta(1, '7', '8', 8)"></div>

            <p>8 -- 9: 7Km</p><br><br>
            <div id="a8-9" data-weight="7" name="a8-9" class="aaresta" style="width: 100px"
                 onclick="adicionarAresta(0, '8', '9', 7)"></div>

            <p>9 -- 10: 18Km</p><br><br>
            <div id="a9-10" data-weight="18" name="a9-10" class="aaresta" style="width: 100px"
                 onclick="adicionarAresta(8, '9', '10', 18)"></div>
        </form>
    </div>
</main>
<script>
    // Mapeamento dos vértices e suas coordenadas
    const vertices = {
        "1": {top: 61, left: 244},
        "2": {top: 128, left: 128},
        "3": {top: 128, left: 347},
        "4": {top: 284, left: 128},
        "5": {top: 282, left: 347},
        "6": {top: 402, left: 128},
        "7": {top: 402, left: 347},
        "8": {top: 445, left: 245},
        "9": {top: 348, left: 238},
        "10": {top: 199, left: 238},
    };

    // Lista de arestas disponíveis
    let arestasDisponiveis = [
        {start: "1", end: "2", weight: 10},
        {start: "1", end: "3", weight: 11},
        {start: "1", end: "10", weight: 14},
        {start: "2", end: "4", weight: 23},
        {start: "3", end: "5", weight: 22},
        {start: "4", end: "6", weight: 15},
        {start: "5", end: "7", weight: 13},
        {start: "6", end: "8", weight: 9},
        {start: "7", end: "8", weight: 8},
        {start: "8", end: "9", weight: 7},
        {start: "9", end: "10", weight: 18},
    ];

    let selectedArestas = []; // Lista para armazenar as arestas selecionadas

    function adicionarAresta(index, start, end, weight) {
        // Verificar se a aresta pode ser adicionada
        if (selectedArestas.length === 0 || weight >= selectedArestas[selectedArestas.length - 1].weight) {
            // Adicionar a aresta à lista
            selectedArestas.push({start, end, weight});

            // Desenhar a aresta no mapa
            desenharAresta(start, end);

            // Remover a aresta disponível
            arestasDisponiveis.splice(index, 1);

            // Verificar se formou um ciclo
            if (formouCiclo()) {
                alert("Você formou um ciclo! Remova uma aresta para continuar.");
            }
        } else {
            alert("Selecione as arestas em ordem crescente de peso.");
        }
    }

    function desenharAresta(start, end) {
        const canvas = document.querySelector(".the-lines");
        const ctx = canvas.getContext("2d");

        const startVertex = vertices[start];
        const endVertex = vertices[end];

        ctx.beginPath();
        ctx.moveTo(startVertex.left, startVertex.top);
        ctx.lineTo(endVertex.left, endVertex.top);
        ctx.stroke();
    }

    function formouCiclo() {
        const parent = new Map();

        function find(x) {
            if (!parent.has(x)) {
                return x;
            }
            return find(parent.get(x));
        }

        for (const vertex of selectedArestas) {
            const { start, end } = vertex;
            const rootStart = find(start);
            const rootEnd = find(end);

            if (rootStart === rootEnd) {
                return true; // Formou um ciclo
            }

            parent.set(rootStart, rootEnd);
        }

        return false;
    }
</script>
</body>
</html>
</body>

</html>
